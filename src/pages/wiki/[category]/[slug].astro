---
import type { GetStaticPaths, MDXInstance } from "$data/shared"
import { postProcessWikiItem, WikiItem } from "$data/wiki"
import WikiLayout from "$layouts/WikiLayout.astro"

export const getStaticPaths: GetStaticPaths = async () => {
  const wikiItems = await Astro.glob<WikiItem>("/content/wiki/**/*.mdx")
  return wikiItems.map((wikiItem) => {
    const augmentedFrontmatter = postProcessWikiItem(wikiItem.frontmatter, wikiItem.file)

    return {
      params: {
        category: augmentedFrontmatter.navigation.category,
        slug: augmentedFrontmatter.slug,
      },
      props: { wikiItem },
    }
  })
}

export interface Props {
  wikiItem: MDXInstance<WikiItem>
}

const { wikiItem } = Astro.props
---

<WikiLayout wikiItem={wikiItem} />
