---
import CatalogueItemLayout from "$layouts/CatalogueItemLayout.astro"
import { postProcessCatalogueItem, CatalogueItem } from "$data/catalogue"
import { getSlugFromFile } from "$utils"

export async function getStaticPaths() {
  const items = await Astro.fetchContent("/content/catalogue/**/*.md")
  return items.map((item) => {
    item = postProcessCatalogueItem(item)

    return {
      params: { type: item.type + "s", slug: getSlugFromFile(item.file.pathname) },
      props: { item },
    }
  })
}

export interface Props {
  item: CatalogueItem
}

const { item } = Astro.props
---

<CatalogueItemLayout catalogueItem={item} />
