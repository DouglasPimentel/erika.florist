---
    import ArticleLayout from '$layouts/ArticleLayout.astro'
    import { basename, extname } from 'node:path'
    import { Article } from '$types/articles'
    import { readableDate } from '$utils'

    export async function getStaticPaths() {
        const articles = await Astro.fetchContent("../../content/articles/**/*.md");
        return articles.map((article) => {
            const dateString = readableDate(new Date(article.date)) // TODO: For some reason, our date become a string, that's weird
            return {
                params: { slug: basename(article.file.pathname, extname(article.file.pathname)) },
                props: { article: {dateString, ...article} }
            }
        })
    }

    export interface Props {
        article: Article
    }

    const { article } = Astro.props
---

<ArticleLayout article={article}/>
