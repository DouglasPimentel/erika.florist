---
import { Article, postProcessArticle } from "$data/articles";
import type { GetStaticPaths, MDXInstance, Page } from "$data/shared";
import ArticleListLayout from "$layouts/ArticleListLayout.astro";

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  let articles = await Astro.glob<Article>("/content/articles/**/*.mdx");
  articles = articles
    .map((article) => ({
      ...article,
      frontmatter: postProcessArticle(article.frontmatter, article.file),
    }))
    .sort((a, b) => {
      return b.frontmatter.date.getTime() - a.frontmatter.date.getTime();
    });

  return paginate(articles, { pageSize: 6 });
};

interface Props {
  page: Page<MDXInstance<Article>>;
}

const { page } = Astro.props;
---

<ArticleListLayout page={page} title="Articles" />
