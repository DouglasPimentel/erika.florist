---
import WikiLayout from "$layouts/WikiLayout.astro"
import { WikiItem, postProcessWikiItem } from "$data/wiki"
import { MarkdownInstance, GetStaticPaths } from "$data/shared"

export const getStaticPaths: GetStaticPaths = async () => {
  const wikiItems = await Astro.glob<WikiItem>("/content/wiki/**/*.md")
  return wikiItems.map((wikiItem) => {
    const augmentedFrontmatter = postProcessWikiItem(wikiItem.frontmatter, wikiItem.file)

    return {
      params: {
        category: augmentedFrontmatter.navigation.category,
        slug: augmentedFrontmatter.slug,
      },
      props: { wikiItem },
    }
  })
}

export interface Props {
  wikiItem: MarkdownInstance<WikiItem>
}

const { wikiItem } = Astro.props as Props
---

<WikiLayout wikiItem={wikiItem} />
