---
import ArticleListLayout from "$layouts/ArticleListLayout.astro"
import { postProcessArticle, Article } from "$data/articles"
import { GetStaticPaths, MarkdownInstance, Page } from "$data/shared"

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  let articles = await Astro.glob<Article>("/content/articles/**/*.md")
  articles = articles
    .map((article) => {
      article.frontmatter = postProcessArticle(article.frontmatter, article.file)
      return article
    })
    .sort((a, b) => {
      return b.frontmatter.date.getTime() - a.frontmatter.date.getTime()
    })

  return paginate(articles, { pageSize: 6 })
}

export interface Props {
  page: Page<MarkdownInstance<Article>>
}

const { page } = Astro.props
---

<ArticleListLayout page={page} title="Articles" />
